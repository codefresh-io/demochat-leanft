#yalm flow
  version: "1.0"
  steps:
    aut-build-step:
      type: "build"
      fail-fast: false
      dockerfile: "Dockerfile"
      image-name: "verchol/demochat-hpe"
      tag: "latest"

    push-prj:
      type: push
      candidate: ${{aut-build-step}}
      tag: latest
      fail-fast: false

    #run-leanft-test:
    #  fail-fast: false
    #  image: "verchol/demochat_ft:master"

    composition-step:
      type: composition
      composition: docker-compose-integration.yml
      composition-candidates:
        test:
          image: "tutum/curl"
          links :
            - web:aut
          depends_on :
            - web
          command: sh -c 'sleep 1000 && curl http://aut:5000 && echo works ? '
